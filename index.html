<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>High-Throughput Risk Data Flow Architecture</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>⚡ High-Throughput Risk Data Flow</h1>
      <p class="subtitle">Asynchronous Microservice Architecture | Zero Ingestion Lag</p>
      
      <div class="metrics">
        <div class="metric">
          <div class="metric-value" id="throughput">0</div>
          <div class="metric-label">Events/sec</div>
        </div>
        <div class="metric">
          <div class="metric-value" id="latency">< 5ms</div>
          <div class="metric-label">Avg Latency</div>
        </div>
        <div class="metric">
          <div class="metric-value">99.9%</div>
          <div class="metric-label">Uptime</div>
        </div>
      </div>
    </header>

    <div class="controls">
      <button class="btn-primary" id="startBtn">
        <i class="fas fa-play"></i>
        <span>Start Flow</span>
      </button>
      <button class="btn-secondary" id="resetBtn">
        <i class="fas fa-rotate-right"></i>
        <span>Reset</span>
      </button>
      <button class="btn-accent" id="speedBtn">
        <i class="fas fa-gauge-high"></i>
        <span>Speed: <span id="speed-label">Normal</span></span>
      </button>
    </div>

    <div class="phase-indicator">
      <h3><i class="fas fa-diagram-project"></i> Processing Phases</h3>
      <div class="phase" id="phase1">
        <span class="phase-number">1</span>
        <strong>Data Acquisition</strong>
        <div style="font-size: 0.85em; color: #94a3b8; margin-top: 5px;">MT5 → Connector → Queue</div>
      </div>
      <div class="phase" id="phase2">
        <span class="phase-number">2</span>
        <strong>Core Processing</strong>
        <div style="font-size: 0.85em; color: #94a3b8; margin-top: 5px;">Risk Engine & Storage</div>
      </div>
      <div class="phase" id="phase3">
        <span class="phase-number">3</span>
        <strong>Presentation</strong>
        <div style="font-size: 0.85em; color: #94a3b8; margin-top: 5px;">API → Auth → Dashboard</div>
      </div>
      <div class="stats">
        <div class="stat-item">
          <span class="stat-label">Packets Sent:</span>
          <span class="stat-value" id="packets-sent">0</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Active Phase:</span>
          <span class="stat-value" id="active-phase">Idle</span>
        </div>
      </div>
    </div>

    <div class="diagram-container">
      <div class="flow-canvas" id="flowCanvas">
        <!-- Column 1: Source -->
        <div class="flow-column">
          <div class="cluster-label"><i class="fas fa-server"></i> Windows Node</div>
          
          <div class="service-card" id="mt5" data-phase="1">
            <div class="service-icon icon-mt5">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="service-title">MT5 Server</div>
            <div class="service-tech">MetaTrader 5</div>
            <div class="service-badge">Trading Engine</div>
          </div>

          <div class="service-card" id="connector" data-phase="1">
            <div class="service-icon icon-connector">
              <i class="fas fa-plug"></i>
            </div>
            <div class="service-title">Connector</div>
            <div class="service-tech">.NET Worker / C++</div>
            <div class="service-badge">1-5s Polling</div>
          </div>
        </div>

        <!-- Column 2: Queue -->
        <div class="flow-column">
          <div class="cluster-label"><i class="fab fa-docker"></i> Kubernetes</div>
          
          <div class="service-card" id="kafka" data-phase="1">
            <div class="service-icon icon-queue">
              <i class="fas fa-stream"></i>
            </div>
            <div class="service-title">Message Queue</div>
            <div class="service-tech">Kafka / NATS</div>
            <div class="service-badge">Async Stream</div>
          </div>
        </div>

        <!-- Column 3: Processing -->
        <div class="flow-column">
          <div class="cluster-label"><i class="fas fa-microchip"></i> Processing Layer</div>
          
          <div class="service-card" id="risk-service" data-phase="2">
            <div class="service-icon icon-service">
              <i class="fas fa-shield-halved"></i>
            </div>
            <div class="service-title">Risk Engine</div>
            <div class="service-tech">Go / .NET Core</div>
            <div class="service-badge">VaR Calculation</div>
          </div>

          <div class="service-card" id="api" data-phase="3">
            <div class="service-icon icon-api">
              <i class="fas fa-code"></i>
            </div>
            <div class="service-title">API Gateway</div>
            <div class="service-tech">ASP.NET Core</div>
            <div class="service-badge">REST + WebSocket + gRPC</div>
          </div>
        </div>

        <!-- Column 4: Storage & Auth -->
        <div class="flow-column">
          <div class="cluster-label"><i class="fas fa-database"></i> Data Layer</div>
          
          <div class="service-card" id="redis" data-phase="2">
            <div class="service-icon icon-database">
              <i class="fas fa-bolt"></i>
            </div>
            <div class="service-title">Redis</div>
            <div class="service-tech">In-Memory Cache</div>
            <div class="service-badge">Real-time</div>
          </div>

          <div class="service-card" id="postgres" data-phase="2">
            <div class="service-icon icon-database">
              <i class="fas fa-table"></i>
            </div>
            <div class="service-title">PostgreSQL</div>
            <div class="service-tech">TimescaleDB</div>
            <div class="service-badge">Time-series</div>
          </div>

          <div class="service-card" id="clickhouse" data-phase="2">
            <div class="service-icon icon-database">
              <i class="fas fa-database"></i>
            </div>
            <div class="service-title">ClickHouse</div>
            <div class="service-tech">Columnar DB</div>
            <div class="service-badge">Analytics</div>
          </div>

          <div class="service-card" id="keycloak" data-phase="3">
            <div class="service-icon icon-auth">
              <i class="fas fa-key"></i>
            </div>
            <div class="service-title">Keycloak</div>
            <div class="service-tech">IAM</div>
            <div class="service-badge">OAuth2 / OIDC</div>
          </div>
        </div>

        <!-- Column 5: Monitoring & Client -->
        <div class="flow-column">
          <div class="cluster-label"><i class="fas fa-users"></i> Client Layer</div>
          
          <div class="service-card" id="browser" data-phase="3">
            <div class="service-icon icon-client">
              <i class="fas fa-desktop"></i>
            </div>
            <div class="service-title">Admin Dashboard</div>
            <div class="service-tech">Next.js / React</div>
            <div class="service-badge">Real-time UI</div>
          </div>

          <div class="service-card" id="monitoring" data-phase="3">
            <div class="service-icon icon-monitor">
              <i class="fas fa-chart-area"></i>
            </div>
            <div class="service-title">Observability</div>
            <div class="service-tech">Prometheus / Grafana</div>
            <div class="service-badge">Metrics + Logs</div>
          </div>
        </div>
      </div>
    </div>

    <div class="legend">
      <h3><i class="fas fa-layer-group"></i> Technology Stack</h3>
      <div class="legend-grid">
        <div class="legend-item">
          <div class="legend-icon icon-mt5"><i class="fas fa-chart-line"></i></div>
          <span>MetaTrader 5 Server</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-connector"><i class="fas fa-plug"></i></div>
          <span>Data Connector</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-queue"><i class="fas fa-stream"></i></div>
          <span>Message Queue</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-service"><i class="fas fa-shield-halved"></i></div>
          <span>Risk Processing</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-database"><i class="fas fa-database"></i></div>
          <span>Data Storage</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-api"><i class="fas fa-code"></i></div>
          <span>API Gateway</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-auth"><i class="fas fa-key"></i></div>
          <span>Authentication</span>
        </div>
        <div class="legend-item">
          <div class="legend-icon icon-client"><i class="fas fa-desktop"></i></div>
          <span>Client Interface</span>
        </div>
      </div>
    </div>
  </div>

  <script src="js/script.js"></script>
</body>
</html>